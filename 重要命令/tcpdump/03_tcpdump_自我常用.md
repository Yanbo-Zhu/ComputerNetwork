
# 1 
```sh
tcpdump -i eth0 -nn -s96 -v port 80 -X proto 17 src 10.10.1.20 dst 10.10.1.20 -w test.pcap
```


- -i : 选择要捕获的接口，通常是以太网卡或无线网卡，也可以是 vlan 或其他特殊接口。如果该系统上只有一个网络接口，则无需指定。
- -nn : 单个 n 表示不解析域名，直接显示 IP；两个 n 表示不解析域名和端口。这样不仅方便查看 IP 和端口号，而且在抓取大量数据时非常高效，因为域名解析会降低抓取速度。
- -s0 : tcpdump 默认只会截取前 96 字节的内容，要想截取所有的报文内容，可以使用 -s number， number 就是你要截取的报文字节数，如果是 0 的话，表示截取报文全部内容。
- -v : 使用 -v，-vv 和 -vvv 来显示更多的详细信息，通常会显示更多与特定协议相关的信息。
- port 80 : 这是一个常见的端口过滤器，表示仅抓取 80 端口上的流量，通常是 HTTP
-  -A 表示使用 ASCII 字符串打印报文的全部数据，这样可以使读取更加简单，方便使用 grep 等工具解析输出内容。
- -X 表示同时使用十六进制和 ASCII 字符串打印报文的全部数据。这两个参数 (-A 和 -X ) 不能一起使用。
- proto 抓取特定协议的数据, 可以加上参数 udp 或 protocol 17，这两个命令意思相同。
- -w -w 选项用来把数据报文输出到文件：
- 

# 2 行缓冲模式 (-l )

如果想实时将抓取到的数据通过管道传递给其他工具来处理，需要使用 -l 选项来开启行缓冲模式（或使用 -c 选项来开启数据包缓冲模式）。使用 -l 选项可以将输出通过立即发送给其他命令，其他命令会立即响应。
$ tcpdump -i eth0 -s0 -l port 80 | grep 'Server:'
