

# NAT_Network_Address_Translation

中间是 Router 
Route的左右两侧 都有一个ip addresse 

![](image/Pasted%20image%2020241112194549.png)


all devices in local network have 32 bit addresses in a “private” IP address space ( 10/8, 172.16/12, 192.168/16 prefixes) that can only be used in local network

advantages:
- ==just one IP address needed from provider ISP for all devices==
- can change addresses of host in local network without notifying outside world
- can change ISP without changing addresses of devices in local network
- security: devices inside local net not directly addressable, visible by outside world



## 1 implementation:

NAT router must (transparently):
- outgoing datagrams: replace (source IP address, port #) of every outgoing datagram to (NAT IP address, new port #)
    - remote clients/servers will respond using (NAT IP address, new port #) as destination address
    - ![](image/Pasted%20image%2020241112201214.png)
- remember (in NAT translation table) every (source IP address, port #) to (NAT IP address, new port #) translation pair
- incoming datagrams: replace (NAT IP address, new port #) in destination fields of every incoming datagram with corresponding (source IP address, port #) stored in NAT table

![](image/Pasted%20image%2020241112201340.png)



- NAT has been controversial:
    - routers “should” only process up to layer 3
    - address “shortage” should be solved by IPv6
    - violates end to end argument (port # manipulation by network layer device)
    - NAT traversal 遍历: what if client wants to connect to server behind NAT?
- but NAT is here to stay: 
    - extensively 广阔的 used in home and institutional nets, 4G/5G cellular nets




