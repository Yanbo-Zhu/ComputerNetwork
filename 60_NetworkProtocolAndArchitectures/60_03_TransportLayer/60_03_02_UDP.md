
# 1 UDP (用户数据包协议User Datagram Protocol)


-  “no frills,” “bare bones” Internet transport protocol
- “best effort” service, UDP segments may be:
    - lost
    - delivered out-of-order to app
- connectionless:
    - no handshaking between UDP sender, receiver
    - each UDP segment handled independently of others


Why is there a UDP?
- no connection establishment (which can add RTT delay)
- simple: no connection state at sender, receiver
- small header size
- no congestion control
    - UDP can blast away as fast as desired!
    - can function in the face of congestion

 
TCP是面向连接的，而UDP是非连接的协议。UDP没有对接受进行确认的标记和确认机制。对丢包的处理是在应用层来完成的。(or accidental arrival).

此处需要重点注意的事情是：在正常情况下，当UDP包到达一个关闭的端口时，会返回一个UDP复位包。由于UDP是非面向连接的, 因此没有任何确认信息来确认包是否正确到达目的地。因此如果你的防火墙丢弃UDP包，它会开放所有的UDP端口(?)。

由于Internet上正常情况下一些包将被丢弃，甚至某些发往已关闭端口(非防火墙的)的UDP包将不会到达目的，它们将返回一个复位UDP包。

因为这个原因，UDP端口扫描总是不精确、不可靠的。

看起来大UDP包的碎片是常见的DOS (Denial of Service)攻击的常见形式 (这里有个DOS攻击的例子，http://grc.com/dos/grcdos.htm ).


# 2 UDP: User Datagram Protocol

- UDP use:
    - streaming multimedia apps (loss tolerant, rate sensitive)
    - DNS
    - SNMP
    - HTTP/3
- if reliable transfer needed over UDP (e.g., HTTP/3)
    - add needed reliability at application layer
    - add congestion control at application layer


![](image/Pasted%20image%2020241207125739.png)


---

Transport Layer Actions
UDP sender actions:
- SNMP msg is passed an application-layer message
- determines UDP segment header fields values
- creates UDP segment
- passes segment to IP


UDP receiver actions:
- receives segment from IP
- extracts application-layer message
- checks UDP checksum header value
- demultiplexes message up to application via socket

# 3 UDP segment header

![](image/Pasted%20image%2020241207130011.png)

# 4 UDP checksum 

![](image/Pasted%20image%2020241207130024.png)


## 4.1 Internet checksum
Goal: detect errors (i.e., flipped bits) in transmitted segment

sender:
- treat contents of UDP segment (including UDP header fields and IP addresses) as sequence of 16-bit integers
- checksum: addition (one’s complement sum) of segment content
- checksum value put into UDP checksum field


receiver:
- compute checksum of received segment
- check if computed checksum equals checksum field value:
    - not equal - error detected
    - equal - no error detected. But maybe errors nonetheless? More later ….


## 4.2 Internet checksum: an example

![](image/Pasted%20image%2020241208170104.png)


Note: when adding numbers, a carryout from the most significant bit needs to be added to the result
Check out the online interactive exercises for more examples: http://gaia.cs.umass.edu/kurose_ross/interactive/


![](image/Pasted%20image%2020241208170245.png)







