# 1 基础

![](image/Pasted%20image%2020241030084331.png)


![](image/Pasted%20image%2020241030084424.png)


![](image/Pasted%20image%2020241030084507.png)

# 2 DNS name resolution

![](image/Pasted%20image%2020241030084557.png)

![](image/Pasted%20image%2020241030084622.png)


## 2.1 **DNS recursive resolver**  (**recursive query**)

A **DNS recursive resolver** is a server in the Domain Name System (DNS) responsible for resolving domain names into IP addresses on behalf of the client, handling the entire lookup process across multiple DNS servers. This process is known as a **recursive query** because the resolver will recursively query other DNS servers until it finds the IP address associated with a domain or concludes the domain doesn’t exist.

How DNS Recursive Resolvers Work
1. **Client Request**: A client (like a web browser) requests the IP address for a domain, such as `www.example.com`.
2. **Resolver Query**:
    - If the resolver doesn't already have this IP address cached, it begins querying other DNS servers:
3. **Root DNS Server**:
    - The resolver first contacts a **root DNS server**, which responds with a referral to the **Top-Level Domain (TLD)** DNS server (e.g., `.com` TLD for `example.com`).
4. **TLD DNS Server**:
    - The resolver then queries the TLD DNS server. The TLD server responds with a referral to the **authoritative name server** for `example.com`.
5. **Authoritative Name Server**:
    - Finally, the resolver queries the authoritative name server for `example.com`, which provides the IP address.
6. **Response to Client**:
    - The resolver caches this result and returns the IP address to the client, allowing it to connect to the website.


# 3 DNS protocol messages


![](image/Pasted%20image%2020241030084950.png)







