
What is network security?
Principles of cryptography
Authentication, message integrity
Securing e-mail
Securing TCP connections: TLS
Network layer security: IPsec
Security in wireless and mobile networks
Operational security: firewalls and IDS

Chapter goals:
- understand principles of network security:
    - cryptography and its many uses beyond “confidentiality”
    - authentication
    - message integrity
- security in practice:
    - firewalls and intrusion detection systems
    - security in application, transport, network, link layers

# 1 network security

- confidentiality: only sender, intended receiver should “understand” message contents
    - sender encrypts message
    - receiver decrypts message
- authentication: sender, receiver want to confirm identity of each other
- message integrity: sender, receiver want to ensure message not altered (in transit, or afterwards) without detection
- access and availability: services must be accessible and available to users


例子 Friends and enemies: Alice, Bob, Trudy
well-known in network security world
Bob, Alice (lovers!) want to communicate “securely”
Trudy (intruder) may intercept, delete, add messages

![](image/Pasted%20image%2020250106172342.png)

Who might Bob and Alice be?
- … well, real-life Bobs and Alices!
- Web browser/server for electronic transactions (e.g., on-line purchases)
- on-line banking client/server
- DNS servers
- BGP routers exchanging routing table updates
- other examples?

---

There are bad guys (and girls) out there!
Q: What can a “bad guy” do?
A: A lot! (recall section 1.6)
- eavesdrop: intercept messages
- actively insert messages into connection
- impersonation: can fake (spoof) source address in packet (or any field in packet)
- hijacking: “take over” ongoing connection by removing sender or receiver, inserting himself in place
- denial of service: prevent service from being used by others (e.g., by overloading resources)


# 2 Principles of cryptography

![](image/Pasted%20image%2020250106172644.png)

Breaking an encryption scheme

- cipher-text only attack: Trudy has ciphertext she can analyze
- two approaches:
    - brute force: search through all keys
    - statistical analysis
- known-plaintext attack: Trudy has plaintext corresponding to ciphertext
    - e.g., in monoalphabetic cipher, Trudy determines pairings for a,l,i,c,e,b,o,
- chosen-plaintext attack: Trudy can get ciphertext for chosen plaintext


## 2.1 Symmetric key cryptography


Symmetric key cryptography
- Bob and Alice share same (symmetric) key: K
    - e.g., key is knowing substitution pattern in mono alphabetic substitution cipher

![](image/Pasted%20image%2020250106172946.png)


Simple encryption scheme
- substitution cipher: substituting one thing for another
    - monoalphabetic cipher: substitute one letter for another
- ![](image/Pasted%20image%2020250106173031.png)

A more sophisticated encryption approach
- n substitution ciphers, M1,M2,…,Mn
- cycling pattern:
    - e.g., n=4: M1,M3,M4,M3,M2; M1,M3,M4,M3,M2; ..
- for each new plaintext symbol, use subsequent substitution pattern in cyclic pattern
    - dog: d from M1, o from M3, g from M4
- Encryption key: n substitution ciphers, and cyclic pattern
    - key need not be just n-bit pattern




Symmetric key crypto: DES
DES: Data Encryption Standard
- US encryption standard [NIST 1993]
- 56-bit symmetric key, 64-bit plaintext input
- block cipher with cipher block chaining
- how secure is DES?
    - DES Challenge: 56-bit-key-encrypted phrase decrypted (brute force) in less than a day
    - no known good analytic attack
- making DES more secure:
    - 3DES: encrypt 3 times with 3 different keys



AES: Advanced Encryption Standard
- Security: 8- 15
- symmetric-key NIST standard, replaced DES (Nov 2001)
- processes data in 128 bit blocks
- 128, 192, or 256 bit keys
- brute force decryption (try each key) taking 1 sec on DES, takes 149 trillion years for AES


## 2.2 Public Key Cryptography

- symmetric key crypto:
    - requires sender, receiver know shared secret key
    - Q: how to agree on key in first place (particularly if never “met”)?
- public key crypto
    - radically different approach [Diffie-Hellman76, RSA78]
    - sender, receiver do not share secret key
    - public encryption key known to all
    - private decryption key known only to receiver


![](image/Pasted%20image%2020250106173628.png)

Public key encryption algorithms
![](image/Pasted%20image%2020250106173708.png)


Prerequisite: modular arithmetic
- x mod n = remainder of x when divide by n
- facts:
    - [(a mod n) + (b mod n)] mod n = (a+b) mod n
    - [(a mod n) - (b mod n)] mod n = (a-b) mod n
    - [(a mod n) * (b mod n)] mod n = (a*b) mod n
- thus
    - (a mod n)d mod n = ad mod n
- example: x=14, n=10, d=2: 
    - ( (x mod n)^d mod n) = 4^2 mod 10 = 6 
    - x^d = 14^2 = 196, x^d mod 10 = 6

## 2.3 RSA

- message: just a bit pattern
- bit pattern can be uniquely represented by an integer number
- thus, encrypting a message is equivalent to encrypting a number

example:
- m= 10010001. This message is uniquely represented by the decimal number 145.
- to encrypt m, we encrypt the corresponding number, which gives a new number (the ciphertext).

Creating public/private key pair
![](image/Pasted%20image%2020250106174042.png)


encryption, decryption
![](image/Pasted%20image%2020250106174055.png)


RSA example
![](image/Pasted%20image%2020250106174110.png)

![](image/Pasted%20image%2020250106174300.png)

![](image/Pasted%20image%2020250106174309.png)


![](image/Pasted%20image%2020250106174317.png)

Why is RSA secure?
suppose you know Bob’s public key (n,e). How hard is it to determine d?
essentially need to find factors of n without knowing the two factors p and q
fact: factoring a big number is hard


RSA in practice: session keys
exponentiation in RSA is computationally intensive
DES is at least 100 times faster than RSA
use public key crypto to establish secure connection, then establish second key – symmetric session key – for encrypting data

session key, KS
Bob and Alice use RSA to exchange a symmetric session key KS
once both have KS, they use symmetric key cryptography



# 3 Authentication, message integrity

![](image/Pasted%20image%2020250106174719.png)

![](image/Pasted%20image%2020250106174727.png)


## 3.1 Digital signatures

用 private key 去加密 一个 message, 这种形式 就是  Digital signature 的一种 

cryptographic technique analogous to hand-written signatures:
▪ sender (Bob) digitally signs document: he is document owner/creator.
▪ verifiable, nonforgeable: recipient (Alice) can prove to someone that Bob, and no one else (including Alice), must have signed document
▪ simple digital signature for message m:
    • Bob signs m by encrypting with his private key KB, creating “signed” message, KB-(m)
![](image/Pasted%20image%2020250106175356.png)


- suppose Alice receives msg m, with signature: m, KB(m)
- Alice verifies m signed by Bob by applying Bob’s public key KB to KB(m) then checks KB(KB(m) ) = m.
- If KB(KB(m) ) = m, whoever signed m must have used Bob’s private key

Alice thus verifies that:
- Bob signed m
- no one else signed m
- Bob signed m and not m’
non-repudiation:
- Alice can take m, and signature KB(m) to court and prove that Bob signed m


## 3.2 Message digests

computationally expensive to public-key-encrypt long messages
goal: fixed-length, easy- to-compute digital “fingerprint”
- apply hash function H to m, get fixed size message digest, H(m)
- ![](image/Pasted%20image%2020250108170405.png)

Hash function properties:
- many-to-1
- produces fixed-size msg digest (fingerprint)
- given message digest x, computationally infeasible to find m such that x = H(m)


Internet checksum: poor crypto hash function
- produces fixed length digest (16-bit sum) of message
- is many-to-one
- ![](image/Pasted%20image%2020250108170514.png)


Digital signature = signed message digest
![](image/Pasted%20image%2020250108170533.png)



Hash function algorithms
- MD5 hash function widely used (RFC 1321)
    - computes 128-bit message digest in 4-step process.
    - arbitrary 128-bit string x, appears difficult to construct msg m whose MD5 hash is equal to x
- SHA-1 is also used
    - US standard [NIST, FIPS PUB 180-1]
    - 160-bit message digest


## 3.3 Public key Certification Authorities (CA)

certification authority (CA): binds public key to particular entity, E
▪ entity (person, website, router) registers its public key with CE provides “proof of identity” to CA
• CA creates certificate binding identity E to E’s public key
• certificate containing E’s public key digitally signed by CA: CA says “this is E’s public key”

![](image/Pasted%20image%2020250108170853.png)


when Alice wants Bob’s public key:
• gets Bob’s certificate (Bob or elsewhere)
• apply CA’s public key to Bob’s certificate, get Bob’s public key

![](image/Pasted%20image%2020250108170942.png)


# 4 Securing e-mail

confidentiality
![](image/Pasted%20image%2020250108171358.png)

![](image/Pasted%20image%2020250108171408.png)


integrity, authentication
![](image/Pasted%20image%2020250108171522.png)

![](image/Pasted%20image%2020250108171534.png)




# 5 Securing TCP connections: TLS

这部分的笔记 直接记载 tls 处


# 6 Network layer security: IPsec


这部分的笔记 直接记载 network layer 处 


# 7 Security in wireless and mobile networks


这里略去 不做笔记 , 因为不重要 


# 8 Operational security: 

## 8.1 firewalls

Firewall: isolates organization’s internal network from larger Internet, allowing some packets to pass, blocking others
![](image/Pasted%20image%2020250108203846.png)

Firewalls: why
- prevent denial of service attacks:
    - SYN flooding: attacker establishes many bogus TCP connections, no resources left for “real” connections
- prevent illegal modification/access of internal data
    - e.g., attacker replaces CIA’s homepage with something else
- allow only authorized access to inside network
    - set of authenticated users/hosts

three types of firewalls:
- stateless packet filters
- stateful packet filters
- application gateways

### 8.1.1 Stateless packet filtering

![](image/Pasted%20image%2020250108204245.png)

- internal network connected to Internet via router firewall
- filters packet-by-packet, decision to forward/drop packet based on:
    - source IP address, destination IP address
    - TCP/UDP source, destination port numbers
    - ICMP message type
    - TCP SYN, ACK bits

- example 1: block incoming and outgoing datagrams with IP protocol field = 17 and with either source or dest port = 23
    - result: all incoming, outgoing UDP flows and telnet connections are blocked
- example 2: block inbound TCP segments with ACK=0
    - result: prevents external clients from making TCP connections with internal clients, but allows internal clients to connect to outside

![](image/Pasted%20image%2020250108204338.png)

Access Control Lists
ACL: table of rules, applied top to bottom to incoming packets: (action, condition) pairs: looks like OpenFlow forwarding (Ch. 4)!
![](image/Pasted%20image%2020250108204403.png)

### 8.1.2 Stateful packet filtering
- stateless packet filter: heavy handed tool
    - admits packets that “make no sense,” e.g., dest port = 80, ACK bit set, even though no TCP connection established:
    - ![](image/Pasted%20image%2020250108204429.png)

- stateful packet filter: track status of every TCP connection
    - track connection setup (SYN), teardown (FIN): determine whether incoming, outgoing packets “makes sense”
    - timeout inactive connections at firewall: no longer admit packets


ACL augmented to indicate need to check connection state table before admitting packet
![](image/Pasted%20image%2020250108204623.png)


### 8.1.3 Aplication Gateways 

- filter packets on application data as well as on IP/TCP/UDP fields.
- example: allow select internal users to telnet outside
![](image/Pasted%20image%2020250108204659.png)

1. require all telnet users to telnet through gateway.
2. for authorized users, gateway sets up telnet connection to dest host
    1. gateway relays data between 2 connections
3. router filter blocks all telnet connections not originating from gateway

### 8.1.4 Limitations of firewalls, gateways

IP spoofing: router can’t know if data “really” comes from claimed source
if multiple apps need special treatment, each has own app. gateway
client software must know how to contact gateway: e.g., must set IP address of proxy in Web browser

filters often use all or nothing policy for UDP
tradeoff: degree of communication with outside world, level of security
many highly protected sites still suffer from attacks


## 8.2 IDS:  Intrusion detection systems


packet filtering:
- operates on TCP/IP headers only
- no correlation check among sessions

IDS: intrusion detection system
- deep packet inspection: look at packet contents (e.g., check character strings in packet against database of known virus, attack strings)
- examine correlation among multiple packets
    - port scanning
    - network mapping
    - DoS attack


multiple IDSs: different types of checking at different locations
![](image/Pasted%20image%2020250108205000.png)



